# Dotbat - 466pt
--------------------------------------
## Topic sumary
This problem give us file `dotbat` and hint `This file is a dotbat, literally! Don't believe me? Try it!`</br>
It [here](https://github.com/Em0t3t/H-cktivityCon-2021-CTF/blob/main/Malware/resources/dotbat)

I renamed it to a bash file and ran it on the following virtual machine. After a few seconds it automatically deletes itself. (sometimes it needs to run as admin)<br>
I tried using Strings and [FLOSS](https://github.com/fireeye/flare-floss) tool but it outputs string with chinese characters
<br>
![](https://github.com/Em0t3t/H-cktivityCon-2021-CTF/blob/main/Malware/resources/dotbat.png)
<br>`Also, I'm Vietnamese. Hoang Sa and Truong Sa belong to Vietnam. Next time, please use Vietnamese to encrypt the file =)))`

In my experience, every time malicious code automatically deletes itself, it will leave something on the system.

I threw it in the sandbox and waited =)))
![](https://i.redd.it/7spxxffhrqa61.jpg)

You can view a full report [here](https://www.joesandbox.com/analysis/485640/0/html)

I see it drop 1 exe file at the path `C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp`
![](https://github.com/Em0t3t/H-cktivityCon-2021-CTF/blob/main/Malware/resources/dotbat-sanbox.png)

It is written in c#
![](https://github.com/Em0t3t/H-cktivityCon-2021-CTF/blob/main/Malware/resources/dotbat-die.png)

I use [dnSpy tool](https://github.com/dnSpy/dnSpy) and get
![](https://github.com/Em0t3t/H-cktivityCon-2021-CTF/blob/main/Malware/resources/dotbat-dnspy.png)
I fixed it to
![](https://github.com/Em0t3t/H-cktivityCon-2021-CTF/blob/main/Malware/resources/dotbat-dnspy1.png)

recompile and run it. we get the flag
`flag{3a75349c5d614587898c785d88da3582}`